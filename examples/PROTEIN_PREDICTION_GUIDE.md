# 蛋白质预测结果解读指南

## 📊 关键信息

### ⚠️ 重要：蛋白质预测输出的是标准化值

根据 CpGPT 官方文档（`tutorials/predict_mortality.ipynb`）：

> **蛋白质模型预测 322 种血浆蛋白质水平，这些值已经标准化为均值=0，方差=1 (μ = 0, σ² = 1)**

这意味着：
- **不需要反标准化**
- **标准化值可以直接使用**
- **这是设计行为，不是错误**

## 🔍 如何理解标准化值

### 标准化值的含义

| 标准化值 | 含义 | 百分位数 | 解释 |
|---------|------|---------|------|
| **-3** | 极低 | ~0.1% | 远低于人群平均水平 |
| **-2** | 很低 | ~2.3% | 明显低于平均水平 |
| **-1** | 偏低 | ~16% | 低于平均水平 |
| **0** | 平均 | 50% | 人群平均水平 |
| **+1** | 偏高 | ~84% | 高于平均水平 |
| **+2** | 很高 | ~97.7% | 明显高于平均水平 |
| **+3** | 极高 | ~99.9% | 远高于人群平均水平 |

### 正常范围

根据正态分布的 68-95-99.7 规则：
- **68%** 的人群在 **[-1, +1]** 范围内
- **95%** 的人群在 **[-2, +2]** 范围内
- **99.7%** 的人群在 **[-3, +3]** 范围内

## 🩺 临床解释

### 对于炎症标志物（如 CRP, IL6, TNF_alpha）

- **负值（< 0）**：✅ **好消息** - 低于平均炎症水平
  - -1 到 -2：炎症水平较低，健康状态良好
  - < -2：炎症水平很低，非常健康

- **正值（> 0）**：⚠️ **需要关注** - 高于平均炎症水平
  - +1 到 +2：炎症水平偏高，可能需要生活方式干预
  - > +2：炎症水平很高，建议医学评估

### 对于心血管标志物（如 ADM, ICAM1, VCAM1）

- **负值**：心血管健康状态较好
- **正值**：心血管风险增加

### 对于肾功能标志物（如 Cystatin_C, B2M）

- **负值**：肾功能良好
- **正值**：肾功能可能下降

## 📈 实际示例

### 示例 1：健康个体

```
ADM: -0.8          # 心血管调节良好
CRP: -1.2          # 炎症水平低
IL6: -0.5          # 炎症标志物正常偏低
Cystatin_C: -0.3   # 肾功能良好
```

**解释**：所有标志物都低于平均水平，表示健康状态良好。

### 示例 2：炎症风险个体

```
ADM: 0.5           # 心血管调节轻度异常
CRP: 2.1           # 炎症水平明显升高 ⚠️
IL6: 1.8           # 炎症标志物升高 ⚠️
TNF_alpha: 1.5     # 炎症因子升高 ⚠️
```

**解释**：多个炎症标志物升高，建议进一步评估和生活方式干预。

### 示例 3：肾功能异常个体

```
Cystatin_C: 2.5    # 肾功能标志物明显升高 ⚠️⚠️
B2M: 2.2           # β2-微球蛋白升高 ⚠️
CRP: 1.0           # 炎症水平偏高
```

**解释**：肾功能标志物显著升高，强烈建议医学评估。

## 🎯 如何使用预测结果

### 1. 查看原始标准化值

```python
import pandas as pd

# 读取蛋白质预测结果
proteins = pd.read_csv('results/935k_enhanced_predictions/proteins_predictions.csv')

# 查看特定蛋白质
print(proteins[['sample_id', 'CRP', 'IL6', 'TNF_alpha', 'Cystatin_C']])
```

### 2. 识别异常值

```python
# 找出高于 +2 标准差的蛋白质（前 2.3%）
high_proteins = proteins.select_dtypes(include='number').columns[
    (proteins.select_dtypes(include='number') > 2).any()
]
print("异常升高的蛋白质:", high_proteins.tolist())

# 找出低于 -2 标准差的蛋白质（后 2.3%）
low_proteins = proteins.select_dtypes(include='number').columns[
    (proteins.select_dtypes(include='number') < -2).any()
]
print("异常降低的蛋白质:", low_proteins.tolist())
```

### 3. 计算风险评分

```python
# CVD 风险评分（基于心血管相关蛋白质）
cvd_proteins = ['ADM', 'CRP', 'IL6', 'ICAM1', 'VCAM1', 'PAI1']
cvd_score = proteins[cvd_proteins].mean(axis=1)

print(f"CVD 风险评分: {cvd_score.values[0]:.2f}")
# 解释：
# < 0: 低风险
# 0-1: 中等风险
# > 1: 高风险
```

## ⚠️ 常见误解

### ❌ 错误理解

> "我的 CRP 值是 1.5，这个数值太小了，是不是预测错了？"

### ✅ 正确理解

> "我的 CRP 标准化值是 +1.5，这意味着我的 CRP 水平高于 93% 的人群，属于偏高水平，需要关注。"

---

### ❌ 错误理解

> "蛋白质值应该是 mg/L 或 ng/mL，为什么是 -0.5 这样的值？"

### ✅ 正确理解

> "模型输出的是标准化值（Z-score），不是实际浓度。标准化值 -0.5 表示低于平均水平约 0.5 个标准差，这是正常的表示方式。"

---

### ❌ 错误理解

> "我需要把这些值转换回实际的蛋白质浓度。"

### ✅ 正确理解

> "标准化值已经足够用于风险评估和健康评分。如果需要实际浓度，需要原始训练数据的均值和标准差，但通常不需要。"

## 📚 技术细节

### 为什么使用标准化值？

1. **不同蛋白质的浓度范围差异巨大**
   - CRP: 0-10 mg/L
   - IL6: 0-100 pg/mL
   - 标准化后可以统一比较

2. **便于风险评估**
   - 标准化值直接反映相对于人群的位置
   - 易于计算综合风险评分

3. **模型训练的标准做法**
   - 提高模型性能
   - 避免数值不稳定

### 如果真的需要实际浓度

如果你有训练数据的统计信息：

```python
# 假设你知道 CRP 的训练数据统计
CRP_mean = 3.5  # mg/L
CRP_std = 2.0   # mg/L

# 转换标准化值为实际浓度
standardized_CRP = 1.5  # 模型输出
actual_CRP = standardized_CRP * CRP_std + CRP_mean
print(f"实际 CRP 浓度: {actual_CRP:.2f} mg/L")
# 输出: 实际 CRP 浓度: 6.50 mg/L
```

**但是**：通常你不需要这样做，标准化值已经足够用于临床解释。

## 🎓 总结

1. ✅ **蛋白质预测输出标准化值是正常的**
2. ✅ **标准化值范围通常在 [-3, +3]**
3. ✅ **负值通常表示更健康**
4. ✅ **正值通常表示风险增加**
5. ✅ **不需要反标准化**
6. ✅ **可以直接用于风险评估**

## 📞 需要帮助？

如果你的蛋白质预测值：
- ✅ 在 [-3, +3] 范围内 → **正常**
- ⚠️ 超出 [-5, +5] 范围 → 可能是数据质量问题
- ⚠️ 所有值都接近 0 → 可能是输入数据问题

请检查：
1. 输入数据格式是否正确
2. 是否有大量缺失值
3. Beta 值是否在 [0, 1] 范围内

